# Basic Information
	Hashrate:
	**3.5T (+-5%)**
	
	Power consumption:
	990W (measure on 12V port of the device)
	1100W (on the wall, with assumption of 90% power conversion ratio)
	
	Power per hash:
	270J/THash (device only)
	295J/THash (on the wall, with assumption of 90% power conversion
	ratio)
	
	Overclocking:
	Support automatically optimize frequency, no need to overclock manually.
	
	PSU output pin:
	4x6PIN PCIe power connector. *All must be connected.*
	
	PSU requirements:
	Minimum 1100W output, recommend to use high-quality PSU for server
	with more than 1200W output and high quality power cable.
	Input voltage no lower than 11.7V and no higher than 12.2V (numbers
	take from the controller)
	Lower voltage leads to lower hashrate and higher voltage leads to
	possible device burning down.
	NOTICE: Poor quality cable may result in low voltage.
	
	Fan:
	Specs: 12038
	Current: between 1.6A and 2.8A.
	Minimum RPM: 3800.
	*NOTICE* If the fan is broken or the fan's RPM cannot be measure,
	the device will not start.
	
	Controller:
	Raspberry Pi (version B or B+)
	Raspberry Pi 2 will be supported at the middle of December 2015
	Each Rpi can control approximately ~12 devices.
	
	AUC:
	Each AUC can connect up to 6 devices.
	
	Dimensions:
	354x136x150mm
	
	Net weight:
	~4.8kg
	
	Protection Degree:
	IP20

## LED


|LED Status|MEMO
|---|---
valign="top"|White|Power on
valign="top"|Blue|Working normally
valign="top"|Yellow blinking|Idle normally
valign="top"|Green blinking|Detect fan and mcu
valign="top"|White blinking|Turn on LED manually
valign="top"|Red blinking|Toohot/Loopback failed/PG failed/Coretest failed/Voltage error/Temperature sensor error/No fan


## MM Error Codes
[Find error here](http://downloads.canaan-creative.com/querystatus.html)


|CODE|NAME|TYPE|MEMO|What to do
|---|---|---|---|---
valign="top"|1|CODE_IDLE|WARN|Idle|Check if the network is ok or AUC is work  normally
valign="top"|2|CODE_TOOHOT|FATAL|Too hot|Check if the fan is connect successfully
valign="top"|4|CODE_LOOP0FAILED|FATAL|Channel 0 loopback failed|Replace a new hash unit  for channel 0 if PG0 is ok
valign="top"|8|CODE_LOOP1FAILED|FATAL|Channel 1 loopback failed|Replace a new hash unit  for channel 1 if PG1 is ok
valign="top"|16|CODE_INVALIDMCU|FATAL|MCU cann't be detected|Replace a new CTRL board
valign="top"|32|CODE_NOSTRATUM|WARN|No stratum|Check if the network is ok or AUC is work  normally
valign="top"|64|CODE_RBOVERFLOW|WARN|Nonce ringbuffer overflow|Ignore it please, If CGMiner is restart, It will be ok. 
valign="top"|128|CODE_MMCRCFAILED|WARN|Ignore it please, If CGMiner is restart, It will be ok. |Find iic rx crc mismatch
valign="top"|256|CODE_MCUCRCFAILED|WARN|Find mcu rx irc mismatch|Ignore it please, If CGMiner is restart, It will be ok. 
valign="top"|512|CODE_NOFAN|FATAL|Fan cann't be found|Check the fan connection
valign="top"|1024|CODE_PG0FAILED|FATAL|Channel 0 power good failed|Check the PSU for channel 0
valign="top"|2048|CODE_PG1FAILED|FATAL|Channel 1 power good failed|Check the PSU for channel 1
valign="top"|4096|CODE_CORETESTFAILED|FATAL|Find bad chip on channel 0 or channel 1|Replace a new hash unit if hash rate is too low, or else you can ignore it.
valign="top"|8192|CODE_ADC0_ERR|FATAL|Temperature sensor cann't be detected on channel 0|Replace a new hash unit  for channel 0
valign="top"|16384|CODE_ADC1_ERR|FATAL|Temperature sensor cann't be detected on channel 1|Replace a new hash unit  for channel 1
valign="top"|32768|CODE_VOL_ERR|FATAL|MM is not permit to run at the voltage for safety|Change another PSU for the machine

TYPE meaning:
	**WARN**-It designates potentially harmful situations, but you can ignore it.
	**FATAL**-It designates very severe error events that will presumably lead the Avalon6 to crash.

# Firmware
## RPi Firmware
### [http://downloads.canaan-creative.com/software/avalon6/openwrt/20151111/ 20151111]

* CGMiner:Fix divide by zero in Avalon4 driver
* CGMiner:Add stratum difficulty in pool api
* CGMiner:Update option for Avalon6
* CGMiner:Update Vol api display in Avalon4 driver for Avalon6
* CGMiner:Update fan adjust for Avalon6
* CGMiner:Update target temp settting for Avalon6
* LuCI:Update display information for Avalon6
* LuCI:Update device name for Avalon6
* LuCI:Update CGMiner configuration for Avalon6
* LuCI:Update CGMiner setting for Avalon theme

### [http://downloads.canaan-creative.com/software/avalon6/openwrt/20151031/ 20151031]

* Fix nonce counter for multiple miners
* Display ASIC counts as TA in CGMiner status
* Update maximum difficulty for Avalon4 and Avalon6
* Update temperature check for Avalon6
* Add GHSmm for hash rate comparison
* Display PLL information for Avalon6
* Turn on nonce check as default for Avalon6
* Correct on voltage decode
* Enable adjust frequency automatically as default for Avalon6
* Decode voltage and temperature decode for Avalon6
* Support err code for Avalon6

### [http://downloads.canaan-creative.com/software/avalon6/openwrt/20151001/ 20151001]

* First version of Avalon6 firmware

### [http://downloads.canaan-creative.com/software/avalon6/openwrt/nexttesting/ NEXT-TESTING]

* NOTICE: Only for testing
* Support Raspberry Pi 2 B
* Update SmartSpeed in CGMiner
* Update Temperature process

## MM Firmware
### [http://downloads.canaan-creative.com/software/avalon6/mm/2015-11-24/ 2015-11-24]

* Version **601511-f4f59c70**
* Update Core test check rules
* Update Input voltage check rules (Input voltage should not >= 12.8V)
* Fix result when run test scripts

### [http://downloads.canaan-creative.com/software/avalon6/mm/2015-11-11/ 2015-11-11]

* Version **601511-e3d244c0 **
* Add voltage range detect
* Check maximum rpm when detect fan polar
* Check temp for bad ntc resistor
* Check voltage when MM is starting
* Monitor powergood when power on
* Update temperature check
* Update nonce process
* Update frequency table
* Fix conflict address
* Enable 25MHz clock for debug purpose
* Disable pll when if miner is invalid when process FREQ_WORK

### [http://downloads.canaan-creative.com/software/avalon6/mm/2015-10-31/ 2015-10-31]

* Version **601510-afa837a0**
* Update IIC and UART communication
* Support core test by AVA4_P_TEST
* Update ASIC_FREQMIN to 100MHz
* Detect ASIC counts by LOOPBACK
* Fix upgrade failed caused by i2c FIFO overflow
* Update timer function
* Use GPIO led as address indicator
* Always disable the invalid miner when PG or LOOPBACK failed
* Add PLL status in P_STATUS_M
* Add err code
* Support ADC capture
* Keep free run if MCU can't be detected
* Update led status
* Rewrite boot loader with c code

### [http://downloads.canaan-creative.com/software/avalon6/mm/2015-09-30/ 2015-09-30]

* Version **601509-a2613610**
* First MM firmware for Avalon6.0 S 
* Support 2 miners
* Detect asic counts when start
* Support target filter

### [http://downloads.canaan-creative.com/software/avalon6/mm/nexttesting/ NEXT-TESTING]

* NOTICE: Only for testing

## MCU Firmware
### [http://downloads.canaan-creative.com/software/avalon6/mm/mcu/2015-10-31/ 2015-10-31]

* Version **6C1508-afa837a0**
* For adc and temperature capture use MM protocal

## AUC2 Firmware
### [http://downloads.canaan-creative.com/software/avalon6/auc2/NEXT-TESTING/ NEXT-TESTING]

* NOTICE: Only for testing
* AUC version: AUC-20151208
* First release

# Software Development
## Controller firmware
### [http://build.canaan-creative.com:8080/~buildbot/avalon6/ Daily building]
### CGMiner Under Ubuntu 14.04
	#Inside your home directory, download Cgminer
	git clone https://github.com/Canaan-Creative/cgminer
	cd cgminer
	git checkout origin/avalon4 -b avalon4
	./autogen.sh --enable-avalon4
	make -j 4
	# Run
	sudo ./cgminer --avalon4-freq 200 --avalon4-voltage 7125 -o http://stratum.pool:3333 -u  work -p pass 
	or
	sudo ./cgminer --avalon4-freq 200 --avalon4-voltage 7125 -o http://stratum.pool:3333 -u  work -p pass --api-allow W:192.168.2,W:192.168.2.1 --api-listen $@ 2>./log

## MM
### [http://build.canaan-creative.com:8080/~buildbot/mm60/ Daily building]
### Avalon6 TB2
	$ make -C firmware PLATFORM=MM60_TB2
### Avalon6.0 S
	$ make -C firmware

## AUC2
### [http://build.canaan-creative.com:8080/~buildbot/auc2/ Daily building]

## TODO
### OpenWrt

1. Support Raspberry Pi 2B
1. Update with the master branch
1. Support Avalon6 in LuCI (Advanced version)
1. Keep more coding on LuCI (Avalon theme)

### CGMiner

1. Add auto speed option
1. Merge the Avalon6 code to CK's master

### MM

1. New board Avalon 6.2 support
1. POST
1. Temperature support
1. LPC11U14 program/update
1. Change stratum code to libstratum.a
1. Support diff = 1

## Known Issues

1. MM Firmware upgrade failed

# FAQ
1. How to deal with the red blinking machine?
	   [[!img "A6_EC_PROC.png" size=640x640]]
2. How to boot the machine or hashboard unit safely?
	   [[!img "A6_BOOT.png" title="none " size=640x640]]
